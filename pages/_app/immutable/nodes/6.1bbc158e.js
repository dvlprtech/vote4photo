import{e as Oe,M as Ut,i as wt,j as Qt,a as De,k as Kt,c as Bt,l as xt,m as en,n as tn,h as nn,o as sn}from"../chunks/fetch-utils.e2def624.js";import{s as Xe,r as on,A as Be,f as E,a as V,g as S,h as L,c as T,d as u,E as tt,j as A,i as w,y as g,K as Q,u as ln,v as an,w as rn,P as Gt,C as nt,B as pt,L as le,p as Ye,W as Rt,X as Je,Y as fn,Z as lt,x as He,_ as Ht,$ as un,e as Ge,R as je,U as Wt,l as R,m as H,z as Me,n as Ee,o as cn,V as pn}from"../chunks/scheduler.03d4e644.js";import{c as qt,F as mn}from"../chunks/contest-store.78c8e617.js";import{g as _n,b as dn,d as Jt,a as $n}from"../chunks/navigation.8ab7a639.js";import{S as Ze,i as Qe,a as d,t as b,b as N,d as M,m as y,e as O,h as at,g as Se,c as Ce}from"../chunks/index.fe1ef296.js";import{e as st,D as xe,a as et}from"../chunks/format-utils.51a71bca.js";import{B as hn,M as gn}from"../chunks/my-card.6987be73.js";import{L as We,f as bn,a as vn,b as wn}from"../chunks/index.c1914628.js";import{t as kt,g as rt,a as Xt,B as Fe}from"../chunks/Button.1f35ac66.js";import{H as mt,T as kn}from"../chunks/Tooltip.13b11af2.js";import{I as _t}from"../chunks/Img.c68d365e.js";import{s as ot}from"../chunks/error-manager.7c808654.js";import{s as Pn}from"../chunks/wallet-store.66caea4d.js";import{w as Yt}from"../chunks/index.4fd934ef.js";import{I as qe}from"../chunks/Input.65c4dd0c.js";import{S as In,a as En}from"../chunks/Spinner.1b42fc1a.js";import{C as Sn}from"../chunks/Checkbox.9149553d.js";function Cn(l){let e,t,n,s,o,a,r,f;const _=l[8].default,p=on(_,l,l[7],null);let $=[l[6],{type:"file"},{class:"hidden"}],c={};for(let m=0;m<$.length;m+=1)c=Be(c,$[m]);return{c(){e=E("button"),t=E("label"),p&&p.c(),n=V(),s=E("input"),this.h()},l(m){e=S(m,"BUTTON",{class:!0,type:!0});var F=L(e);t=S(F,"LABEL",{class:!0,tabindex:!0});var j=L(t);p&&p.l(j),n=T(j),s=S(j,"INPUT",{type:!0,class:!0}),j.forEach(u),F.forEach(u),this.h()},h(){tt(s,c),A(t,"class","flex flex-col items-center"),A(t,"tabindex","0"),A(e,"class",o=kt(l[2],l[5].class)),A(e,"type","button")},m(m,F){w(m,e,F),g(e,t),p&&p.m(t,null),g(t,n),g(t,s),s.autofocus&&s.focus(),l[21](s),a=!0,r||(f=[Q(s,"change",l[20]),Q(s,"change",l[18]),Q(s,"click",l[19]),Q(e,"keydown",l[4]),Q(e,"focus",l[9]),Q(e,"blur",l[10]),Q(e,"mouseenter",l[11]),Q(e,"mouseleave",l[12]),Q(e,"mouseover",l[13]),Q(e,"dragenter",l[14]),Q(e,"dragleave",l[15]),Q(e,"dragover",l[16]),Q(e,"drop",l[17])],r=!0)},p(m,[F]){p&&p.p&&(!a||F&128)&&ln(p,_,m,m[7],a?rn(_,m[7],F,null):an(m[7]),null),tt(s,c=rt($,[F&64&&m[6],{type:"file"},{class:"hidden"}])),(!a||F&36&&o!==(o=kt(m[2],m[5].class)))&&A(e,"class",o)},i(m){a||(d(p,m),a=!0)},o(m){b(p,m),a=!1},d(m){m&&u(e),p&&p.d(m),l[21](null),r=!1,Gt(f)}}}function Dn(l,e,t){const n=["value","files","defaultClass"];let s=nt(e,n),{$$slots:o={},$$scope:a}=e,{value:r=""}=e,{files:f=void 0}=e,{defaultClass:_="flex flex-col justify-center items-center w-full h-64 bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"}=e,p;function $(i){[" ","Enter"].includes(i.key)&&(i.preventDefault(),p.click())}function c(i){le.call(this,l,i)}function m(i){le.call(this,l,i)}function F(i){le.call(this,l,i)}function j(i){le.call(this,l,i)}function B(i){le.call(this,l,i)}function W(i){le.call(this,l,i)}function J(i){le.call(this,l,i)}function P(i){le.call(this,l,i)}function I(i){le.call(this,l,i)}function q(i){le.call(this,l,i)}function C(i){le.call(this,l,i)}function k(){r=this.value,f=this.files,t(0,r),t(1,f)}function z(i){Ye[i?"unshift":"push"](()=>{p=i,t(3,p)})}return l.$$set=i=>{t(5,e=Be(Be({},e),pt(i))),t(6,s=nt(e,n)),"value"in i&&t(0,r=i.value),"files"in i&&t(1,f=i.files),"defaultClass"in i&&t(2,_=i.defaultClass),"$$scope"in i&&t(7,a=i.$$scope)},e=pt(e),[r,f,_,p,$,e,s,a,o,c,m,F,j,B,W,J,P,I,q,C,k,z]}class Vn extends Ze{constructor(e){super(),Qe(this,e,Dn,Cn,Xe,{value:0,files:1,defaultClass:2})}}function Tn(l){let e,t,n,s=[l[16],{type:"number"}],o={};for(let a=0;a<s.length;a+=1)o=Be(o,s[a]);return{c(){e=E("input"),this.h()},l(a){e=S(a,"INPUT",{type:!0}),this.h()},h(){tt(e,o)},m(a,r){w(a,e,r),e.autofocus&&e.focus(),Je(e,l[0]),t||(n=[Q(e,"input",l[15]),Q(e,"blur",l[2]),Q(e,"change",l[3]),Q(e,"click",l[4]),Q(e,"contextmenu",l[5]),Q(e,"focus",l[6]),Q(e,"keydown",l[7]),Q(e,"keypress",l[8]),Q(e,"keyup",l[9]),Q(e,"mouseover",l[10]),Q(e,"mouseenter",l[11]),Q(e,"mouseleave",l[12]),Q(e,"paste",l[13]),Q(e,"input",l[14])],t=!0)},p(a,r){tt(e,o=rt(s,[r&65536&&a[16],{type:"number"}])),r&1&&Rt(e.value)!==a[0]&&Je(e,a[0])},d(a){a&&u(e),t=!1,Gt(n)}}}function Nn(l){let e,t;const n=[l[1]];let s={$$slots:{default:[Tn,({props:o})=>({16:o}),({props:o})=>o?65536:0]},$$scope:{ctx:l}};for(let o=0;o<n.length;o+=1)s=Be(s,n[o]);return e=new qe({props:s}),{c(){N(e.$$.fragment)},l(o){M(e.$$.fragment,o)},m(o,a){y(e,o,a),t=!0},p(o,[a]){const r=a&2?rt(n,[Xt(o[1])]):{};a&196609&&(r.$$scope={dirty:a,ctx:o}),e.$set(r)},i(o){t||(d(e.$$.fragment,o),t=!0)},o(o){b(e.$$.fragment,o),t=!1},d(o){O(e,o)}}}function Mn(l,e,t){const n=["value"];let s=nt(e,n),{value:o=0}=e;function a(I){le.call(this,l,I)}function r(I){le.call(this,l,I)}function f(I){le.call(this,l,I)}function _(I){le.call(this,l,I)}function p(I){le.call(this,l,I)}function $(I){le.call(this,l,I)}function c(I){le.call(this,l,I)}function m(I){le.call(this,l,I)}function F(I){le.call(this,l,I)}function j(I){le.call(this,l,I)}function B(I){le.call(this,l,I)}function W(I){le.call(this,l,I)}function J(I){le.call(this,l,I)}function P(){o=Rt(this.value),t(0,o)}return l.$$set=I=>{e=Be(Be({},e),pt(I)),t(1,s=nt(e,n)),"value"in I&&t(0,o=I.value)},[o,s,a,r,f,_,p,$,c,m,F,j,B,W,J,P]}class yn extends Ze{constructor(e){super(),Qe(this,e,Mn,Nn,Xe,{value:0})}}const On=async({})=>{const l=fn(qt);if(console.log("contestId",l),!l){_n("/app/contests");return}let e={},t={};const n=await Oe(`/api/contest/${l}`);n.status===200&&(e=await n.json());const s=await Oe("/api/config/fees");return s.status===200&&(t=await s.json()),{contestData:e,fees:t}},Bs=Object.freeze(Object.defineProperty({__proto__:null,load:On},Symbol.toStringTag,{value:"Module"})),Pt=l=>{switch(l){case"active":return"Activo";case"finished":return"Finalizado";case"pending":return"Pendiente"}},It=l=>{switch(l){case"active":return"green";case"finished":return"gray";case"pending":return"blue"}};function Et(l,e,t){const n=l.slice();return n[29]=e[t],n}function St(l){let e,t;return e=new In({props:{id:"",name:"userPhoto",class:"mb-2",placeholder:"",$$slots:{default:[Fn]},$$scope:{ctx:l}}}),e.$on("change",l[10]),{c(){N(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){y(e,n,s),t=!0},p(n,s){const o={};s[0]&32|s[1]&2&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){b(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Ct(l){let e,t=l[29].title+"",n,s;return{c(){e=E("option"),n=R(t),this.h()},l(o){e=S(o,"OPTION",{});var a=L(e);n=H(a,t),a.forEach(u),this.h()},h(){e.__value=s=l[29].id,Je(e,e.__value)},m(o,a){w(o,e,a),g(e,n)},p(o,a){a[0]&32&&t!==(t=o[29].title+"")&&Ee(n,t),a[0]&32&&s!==(s=o[29].id)&&(e.__value=s,Je(e,e.__value))},d(o){o&&u(e)}}}function Fn(l){let e,t="Nueva foto",n,s,o=st(l[5]),a=[];for(let r=0;r<o.length;r+=1)a[r]=Ct(Et(l,o,r));return{c(){e=E("option"),e.textContent=t,n=V();for(let r=0;r<a.length;r+=1)a[r].c();s=Ge(),this.h()},l(r){e=S(r,"OPTION",{"data-svelte-h":!0}),je(e)!=="svelte-ujsr34"&&(e.textContent=t),n=T(r);for(let f=0;f<a.length;f+=1)a[f].l(r);s=Ge(),this.h()},h(){e.__value="0",Je(e,e.__value),e.selected=!0},m(r,f){w(r,e,f),w(r,n,f);for(let _=0;_<a.length;_+=1)a[_]&&a[_].m(r,f);w(r,s,f)},p(r,f){if(f[0]&32){o=st(r[5]);let _;for(_=0;_<o.length;_+=1){const p=Et(r,o,_);a[_]?a[_].p(p,f):(a[_]=Ct(p),a[_].c(),a[_].m(s.parentNode,s))}for(;_<a.length;_+=1)a[_].d(1);a.length=o.length}},d(r){r&&(u(e),u(n),u(s)),Wt(a,r)}}}function jn(l){let e;return{c(){e=R("Foto")},l(t){e=H(t,"Foto")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function zn(l){let e,t;return e=new Vn({props:{id:"dropzone",$$slots:{default:[Ln]},$$scope:{ctx:l}}}),e.$on("drop",l[14]),e.$on("dragover",Zn),e.$on("change",l[15]),{c(){N(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){y(e,n,s),t=!0},p(n,s){const o={};s[0]&16|s[1]&2&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){b(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function An(l){let e,t;return e=new _t({props:{src:`/api/photo/${l[9]}`,class:"w-full h-auto"}}),{c(){N(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){y(e,n,s),t=!0},p(n,s){const o={};s[0]&512&&(o.src=`/api/photo/${n[9]}`),e.$set(o)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){b(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function Dt(l){let e,t,n,s=l[4].name+"",o;return{c(){e=E("div"),t=V(),n=E("p"),o=R(s),this.h()},l(a){e=S(a,"DIV",{class:!0}),L(e).forEach(u),t=T(a),n=S(a,"P",{class:!0});var r=L(n);o=H(r,s),r.forEach(u),this.h()},h(){A(e,"class","border-t-2 h-1 w-full mt-2"),A(n,"class","mb-2 text-sm text-gray-600 font-semibold")},m(a,r){w(a,e,r),w(a,t,r),w(a,n,r),g(n,o)},p(a,r){r[0]&16&&s!==(s=a[4].name+"")&&Ee(o,s)},d(a){a&&(u(e),u(t),u(n))}}}function Ln(l){let e,t,n,s='<span class="font-semibold">Pincha para subir una foto</span> o haz drag&amp;drop',o,a,r="SVG, PNG, JPG or GIF",f,_,p;e=new De({props:{icon:Kt,class:"text-3xl text-gray-400 mb-2"}});let $=l[4]&&Dt(l);return{c(){N(e.$$.fragment),t=V(),n=E("p"),n.innerHTML=s,o=V(),a=E("p"),a.textContent=r,f=V(),$&&$.c(),_=Ge(),this.h()},l(c){M(e.$$.fragment,c),t=T(c),n=S(c,"P",{class:!0,"data-svelte-h":!0}),je(n)!=="svelte-1ypyklf"&&(n.innerHTML=s),o=T(c),a=S(c,"P",{class:!0,"data-svelte-h":!0}),je(a)!=="svelte-1wyiql4"&&(a.textContent=r),f=T(c),$&&$.l(c),_=Ge(),this.h()},h(){A(n,"class","mb-2 text-sm text-gray-500"),A(a,"class","text-xs text-gray-500")},m(c,m){y(e,c,m),w(c,t,m),w(c,n,m),w(c,o,m),w(c,a,m),w(c,f,m),$&&$.m(c,m),w(c,_,m),p=!0},p(c,m){c[4]?$?$.p(c,m):($=Dt(c),$.c(),$.m(_.parentNode,_)):$&&($.d(1),$=null)},i(c){p||(d(e.$$.fragment,c),p=!0)},o(c){b(e.$$.fragment,c),p=!1},d(c){c&&(u(t),u(n),u(o),u(a),u(f),u(_)),O(e,c),$&&$.d(c)}}}function Un(l){let e;return{c(){e=R("Título")},l(t){e=H(t,"Título")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function Kn(l){let e;return{c(){e=R("Precio de venta")},l(t){e=H(t,"Precio de venta")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function Bn(l){let e,t="€";return{c(){e=E("span"),e.textContent=t,this.h()},l(n){e=S(n,"SPAN",{slot:!0,class:!0,"data-svelte-h":!0}),je(e)!=="svelte-1u0ongp"&&(e.textContent=t),this.h()},h(){A(e,"slot","right"),A(e,"class","text-gray-500")},m(n,s){w(n,e,s)},p:Me,d(n){n&&u(e)}}}function Gn(l){let e;return{c(){e=R("Fondos")},l(t){e=H(t,"Fondos")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function Rn(l){let e,t="€";return{c(){e=E("span"),e.textContent=t,this.h()},l(n){e=S(n,"SPAN",{slot:!0,class:!0,"data-svelte-h":!0}),je(e)!=="svelte-1u0ongp"&&(e.textContent=t),this.h()},h(){A(e,"slot","right"),A(e,"class","text-gray-500")},m(n,s){w(n,e,s)},p:Me,d(n){n&&u(e)}}}function Hn(l){let e;return{c(){e=R("Tasa inscripción")},l(t){e=H(t,"Tasa inscripción")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function Wn(l){let e,t="€";return{c(){e=E("span"),e.textContent=t,this.h()},l(n){e=S(n,"SPAN",{slot:!0,class:!0,"data-svelte-h":!0}),je(e)!=="svelte-1u0ongp"&&(e.textContent=t),this.h()},h(){A(e,"slot","right"),A(e,"class","text-gray-500")},m(n,s){w(n,e,s)},p:Me,d(n){n&&u(e)}}}function Vt(l){let e,t,n;return t=new mt({props:{$$slots:{default:[qn]},$$scope:{ctx:l}}}),{c(){e=E("div"),N(t.$$.fragment)},l(s){e=S(s,"DIV",{});var o=L(e);M(t.$$.fragment,o),o.forEach(u)},m(s,o){w(s,e,o),y(t,e,null),n=!0},i(s){n||(d(t.$$.fragment,s),n=!0)},o(s){b(t.$$.fragment,s),n=!1},d(s){s&&u(e),O(t)}}}function qn(l){let e;return{c(){e=R("Esta operación puede tardar hasta un minuto en función de la carga de la red, por favor, sea paciente y no cierre la ventana")},l(t){e=H(t,"Esta operación puede tardar hasta un minuto en función de la carga de la red, por favor, sea paciente y no cierre la ventana")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function Jn(l){let e,t,n,s;return e=new De({props:{icon:l[1],class:"w-5 h-5 mr-1"}}),{c(){N(e.$$.fragment),t=V(),n=R(l[2])},l(o){M(e.$$.fragment,o),t=T(o),n=H(o,l[2])},m(o,a){y(e,o,a),w(o,t,a),w(o,n,a),s=!0},p(o,a){const r={};a[0]&2&&(r.icon=o[1]),e.$set(r),(!s||a[0]&4)&&Ee(n,o[2])},i(o){s||(d(e.$$.fragment,o),s=!0)},o(o){b(e.$$.fragment,o),s=!1},d(o){o&&(u(t),u(n)),O(e,o)}}}function Xn(l){let e,t,n,s,o,a,r,f,_,p,$,c,m,F,j,B,W,J,P,I,q,C,k,z,i,Y,ae,re,he,ce,ve,U,G,x,ie,we,ge,X=l[5].length>0&&St(l);o=new We({props:{for:"dropzone",class:"mb-2",$$slots:{default:[jn]},$$scope:{ctx:l}}});const ke=[An,zn],Ve=[];function ze(v,K){return v[9]?0:1}r=ze(l),f=Ve[r]=ke[r](l),c=new We({props:{for:"title",class:"mb-2",$$slots:{default:[Un]},$$scope:{ctx:l}}});const Pe=[{type:"text"},{id:"title"},{name:"title"},{placeholder:"Título"},l[7],{required:!0},{disabled:!!l[9]}];let Ae={};for(let v=0;v<Pe.length;v+=1)Ae=Be(Ae,Pe[v]);F=new qe({props:Ae}),W=new We({props:{for:"salePrice",class:"mb-2",$$slots:{default:[Kn]},$$scope:{ctx:l}}}),P=new qe({props:{type:"number",id:"salePrice",name:"salePrice",disabled:!l[9],$$slots:{right:[Bn]},$$scope:{ctx:l}}}),k=new We({props:{for:"funds",class:"mb-2",$$slots:{default:[Gn]},$$scope:{ctx:l}}}),i=new qe({props:{id:"funds",name:"funds",value:l[6],readonly:!0,disabled:!0,$$slots:{right:[Rn]},$$scope:{ctx:l}}}),re=new We({props:{for:"fee",class:"mb-2",$$slots:{default:[Hn]},$$scope:{ctx:l}}}),ce=new qe({props:{id:"fee",name:"fee",value:l[8],readonly:!0,color:l[6]<l[8]?"red":void 0,$$slots:{right:[Wn]},$$scope:{ctx:l}}});let ne=l[9]&&!!l[3]&&Vt(l);return x=new Fe({props:{type:"submit",class:"w-52",outline:!0,disabled:l[6]<l[8],$$slots:{default:[Jn]},$$scope:{ctx:l}}}),{c(){e=E("form"),t=E("div"),n=E("div"),X&&X.c(),s=V(),N(o.$$.fragment),a=V(),f.c(),_=V(),p=E("div"),$=E("div"),N(c.$$.fragment),m=V(),N(F.$$.fragment),j=V(),B=E("div"),N(W.$$.fragment),J=V(),N(P.$$.fragment),I=V(),q=E("div"),C=E("div"),N(k.$$.fragment),z=V(),N(i.$$.fragment),Y=V(),ae=E("div"),N(re.$$.fragment),he=V(),N(ce.$$.fragment),ve=V(),ne&&ne.c(),U=V(),G=E("div"),N(x.$$.fragment),this.h()},l(v){e=S(v,"FORM",{});var K=L(e);t=S(K,"DIV",{class:!0});var Ie=L(t);n=S(Ie,"DIV",{});var fe=L(n);X&&X.l(fe),s=T(fe),M(o.$$.fragment,fe),a=T(fe),f.l(fe),fe.forEach(u),_=T(Ie),p=S(Ie,"DIV",{class:!0});var me=L(p);$=S(me,"DIV",{});var $e=L($);M(c.$$.fragment,$e),m=T($e),M(F.$$.fragment,$e),$e.forEach(u),j=T(me),B=S(me,"DIV",{});var Te=L(B);M(W.$$.fragment,Te),J=T(Te),M(P.$$.fragment,Te),Te.forEach(u),I=T(me),q=S(me,"DIV",{class:!0});var pe=L(q);C=S(pe,"DIV",{});var _e=L(C);M(k.$$.fragment,_e),z=T(_e),M(i.$$.fragment,_e),_e.forEach(u),Y=T(pe),ae=S(pe,"DIV",{});var Z=L(ae);M(re.$$.fragment,Z),he=T(Z),M(ce.$$.fragment,Z),Z.forEach(u),pe.forEach(u),ve=T(me),ne&&ne.l(me),U=T(me),G=S(me,"DIV",{class:!0});var ee=L(G);M(x.$$.fragment,ee),ee.forEach(u),me.forEach(u),Ie.forEach(u),K.forEach(u),this.h()},h(){A(q,"class","flex flex-row gap-2"),A(G,"class","flex justify-end col-span-2"),A(p,"class","flex flex-col gap-2"),A(t,"class","grid gap-4 mb-4 grid-cols-1 sm:grid-cols-2")},m(v,K){w(v,e,K),g(e,t),g(t,n),X&&X.m(n,null),g(n,s),y(o,n,null),g(n,a),Ve[r].m(n,null),g(t,_),g(t,p),g(p,$),y(c,$,null),g($,m),y(F,$,null),g(p,j),g(p,B),y(W,B,null),g(B,J),y(P,B,null),g(p,I),g(p,q),g(q,C),y(k,C,null),g(C,z),y(i,C,null),g(q,Y),g(q,ae),y(re,ae,null),g(ae,he),y(ce,ae,null),g(p,ve),ne&&ne.m(p,null),g(p,U),g(p,G),y(x,G,null),ie=!0,we||(ge=Q(e,"submit",un(l[11])),we=!0)},p(v,K){v[5].length>0?X?(X.p(v,K),K[0]&32&&d(X,1)):(X=St(v),X.c(),d(X,1),X.m(n,s)):X&&(Se(),b(X,1,1,()=>{X=null}),Ce());const Ie={};K[1]&2&&(Ie.$$scope={dirty:K,ctx:v}),o.$set(Ie);let fe=r;r=ze(v),r===fe?Ve[r].p(v,K):(Se(),b(Ve[fe],1,1,()=>{Ve[fe]=null}),Ce(),f=Ve[r],f?f.p(v,K):(f=Ve[r]=ke[r](v),f.c()),d(f,1),f.m(n,null));const me={};K[1]&2&&(me.$$scope={dirty:K,ctx:v}),c.$set(me);const $e=K[0]&640?rt(Pe,[Pe[0],Pe[1],Pe[2],Pe[3],K[0]&128&&Xt(v[7]),Pe[5],K[0]&512&&{disabled:!!v[9]}]):{};F.$set($e);const Te={};K[1]&2&&(Te.$$scope={dirty:K,ctx:v}),W.$set(Te);const pe={};K[0]&512&&(pe.disabled=!v[9]),K[1]&2&&(pe.$$scope={dirty:K,ctx:v}),P.$set(pe);const _e={};K[1]&2&&(_e.$$scope={dirty:K,ctx:v}),k.$set(_e);const Z={};K[0]&64&&(Z.value=v[6]),K[1]&2&&(Z.$$scope={dirty:K,ctx:v}),i.$set(Z);const ee={};K[1]&2&&(ee.$$scope={dirty:K,ctx:v}),re.$set(ee);const te={};K[0]&256&&(te.value=v[8]),K[0]&320&&(te.color=v[6]<v[8]?"red":void 0),K[1]&2&&(te.$$scope={dirty:K,ctx:v}),ce.$set(te),v[9]&&v[3]?ne?K[0]&520&&d(ne,1):(ne=Vt(v),ne.c(),d(ne,1),ne.m(p,U)):ne&&(Se(),b(ne,1,1,()=>{ne=null}),Ce());const se={};K[0]&320&&(se.disabled=v[6]<v[8]),K[0]&6|K[1]&2&&(se.$$scope={dirty:K,ctx:v}),x.$set(se)},i(v){ie||(d(X),d(o.$$.fragment,v),d(f),d(c.$$.fragment,v),d(F.$$.fragment,v),d(W.$$.fragment,v),d(P.$$.fragment,v),d(k.$$.fragment,v),d(i.$$.fragment,v),d(re.$$.fragment,v),d(ce.$$.fragment,v),d(ne),d(x.$$.fragment,v),ie=!0)},o(v){b(X),b(o.$$.fragment,v),b(f),b(c.$$.fragment,v),b(F.$$.fragment,v),b(W.$$.fragment,v),b(P.$$.fragment,v),b(k.$$.fragment,v),b(i.$$.fragment,v),b(re.$$.fragment,v),b(ce.$$.fragment,v),b(ne),b(x.$$.fragment,v),ie=!1},d(v){v&&u(e),X&&X.d(),O(o),Ve[r].d(),O(c),O(F),O(W),O(P),O(k),O(i),O(re),O(ce),ne&&ne.d(),O(x),we=!1,ge()}}}function Yn(l){let e,t,n;function s(a){l[18](a)}let o={title:"Subir foto",class:"min-w-full",$$slots:{default:[Xn]},$$scope:{ctx:l}};return l[0]!==void 0&&(o.open=l[0]),e=new Ut({props:o}),Ye.push(()=>at(e,"open",s)),e.$on("close",l[12]),{c(){N(e.$$.fragment)},l(a){M(e.$$.fragment,a)},m(a,r){y(e,a,r),n=!0},p(a,r){const f={};r[0]&1022|r[1]&2&&(f.$$scope={dirty:r,ctx:a}),!t&&r[0]&1&&(t=!0,f.open=a[0],lt(()=>t=!1)),e.$set(f)},i(a){n||(d(e.$$.fragment,a),n=!0)},o(a){b(e.$$.fragment,a),n=!1},d(a){O(e,a)}}}const Zn=l=>{l.preventDefault()};function Qn(l,e,t){let n,s,o,a,r;He(l,dn,U=>t(21,a=U)),He(l,Jt,U=>t(22,r=U));const f=Ht(),_=async()=>{const U=await Oe(`/api/account/${r}`);if(U.status===200){const G=await U.json();t(6,ae=G.funds);const x=G.photos;t(5,Y=x.filter(ie=>!ie.currentContestId&&ie.account.toLowerCase()===a))}},p=()=>{C.set(""),t(4,i=null),t(1,I=wt),t(2,q="Preparar foto"),t(8,s=P==null?void 0:P.CONTEST_NEW_PHOTO),n=null,t(7,re={})},$=(U,G="Enviar foto y firma")=>{C.set(U),t(1,I=Qt),t(2,q=G)},c=U=>{const G=parseInt(U.target.value);if(!G)p();else{const x=Y.find(ie=>ie.id===G);x?(t(8,s=P==null?void 0:P.CONTEST),n=x,t(7,re={value:x.title,readonly:!0}),$(x.photoKey,"Enviar foto")):p()}},m=async U=>{const G=new FormData(U),ie={salePrice:Number(G.get("salePrice")),photoKey:o};if(!n){const ge=await Pn(k,z);if(!ge){ot("No se ha podido firmar el mensaje");return}ie.signedMessage={...k,signature:ge}}const we=await Oe(`/api/contest/${J}/addphoto`,{method:"POST",payload:ie});if(we.status===200){t(3,k=null),p();const ge=await we.json();f("close",{}),f("created",ge),_()}},F=async U=>{const G=new FormData,ie=new FormData(U).get("title");if(!n){const X=i;if(!X){ot("No se ha incluido la foto");return}G.append("photo",X)}G.append("title",ie);const we=n?`/api/photo/prepare/${n.id}`:"/api/photo/prepare",ge=await Oe(we,{method:"POST",body:G});if(ge.status===200){const X=await ge.json();t(3,k=X.messageToSign),z=X.domain,$(X.photoKey),setTimeout(()=>{const ke=document.getElementById("salePrice");ke==null||ke.focus()},50)}},j=async U=>{U.preventDefault();const G=U.target;o?await m(G):await F(G)},B=async()=>{o&&await Oe(`/api/photo/${o}`,{method:"DELETE"}),f("close",{})};let{openModal:W=!1}=e,{contestId:J=null}=e,{fees:P}=e,I=wt,q="Preparar foto";const C=Yt("");He(l,C,U=>t(9,o=U));let k=null,z,i=null,Y=[],ae=0,re={};_();const he=U=>{var x;U.preventDefault();const G=(x=U.dataTransfer)==null?void 0:x.files;G!=null&&G.length&&t(4,i=G[0])},ce=U=>{var x;U.preventDefault();const G=(x=U.target)==null?void 0:x.files;G!=null&&G.length&&t(4,i=G[0])};function ve(U){W=U,t(0,W)}return l.$$set=U=>{"openModal"in U&&t(0,W=U.openModal),"contestId"in U&&t(16,J=U.contestId),"fees"in U&&t(17,P=U.fees)},l.$$.update=()=>{l.$$.dirty[0]&131072&&t(8,s=(P==null?void 0:P.CONTEST_NEW_PHOTO)||0)},n=null,[W,I,q,k,i,Y,ae,re,s,o,c,j,B,C,he,ce,J,P,ve]}class xn extends Ze{constructor(e){super(),Qe(this,e,Qn,Yn,Xe,{openModal:0,contestId:16,fees:17},null,[-1,-1])}}function es(l){let e;return{c(){e=R("Votos:")},l(t){e=H(t,"Votos:")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function ts(l){let e,t,n="5",s;return e=new De({props:{icon:Bt,size:"md"}}),{c(){N(e.$$.fragment),t=E("span"),t.textContent=n,this.h()},l(o){M(e.$$.fragment,o),t=S(o,"SPAN",{class:!0,"data-svelte-h":!0}),je(t)!=="svelte-31v3j7"&&(t.textContent=n),this.h()},h(){A(t,"class","text-md")},m(o,a){y(e,o,a),w(o,t,a),s=!0},p:Me,i(o){s||(d(e.$$.fragment,o),s=!0)},o(o){b(e.$$.fragment,o),s=!1},d(o){o&&u(t),O(e,o)}}}function ns(l){let e,t,n,s;return e=new De({props:{icon:xt,size:"md"}}),{c(){N(e.$$.fragment),t=V(),n=E("div"),this.h()},l(o){M(e.$$.fragment,o),t=T(o),n=S(o,"DIV",{class:!0}),L(n).forEach(u),this.h()},h(){A(n,"class","h-4")},m(o,a){y(e,o,a),w(o,t,a),w(o,n,a),s=!0},p:Me,i(o){s||(d(e.$$.fragment,o),s=!0)},o(o){b(e.$$.fragment,o),s=!1},d(o){o&&(u(t),u(n)),O(e,o)}}}function Tt(l){let e,t,n,s,o,a;function r(_){l[16](_)}let f={color:"primary","aria-describedby":"helper-wantbuy",$$slots:{default:[ss]},$$scope:{ctx:l}};return l[3]!==void 0&&(f.checked=l[3]),t=new Sn({props:f}),Ye.push(()=>at(t,"checked",r)),o=new mt({props:{id:"helper-wantbuy",class:"ps-6",$$slots:{default:[os]},$$scope:{ctx:l}}}),{c(){e=E("div"),N(t.$$.fragment),s=V(),N(o.$$.fragment),this.h()},l(_){e=S(_,"DIV",{class:!0});var p=L(e);M(t.$$.fragment,p),s=T(p),M(o.$$.fragment,p),p.forEach(u),this.h()},h(){A(e,"class","sm:col-span-2")},m(_,p){w(_,e,p),y(t,e,null),g(e,s),y(o,e,null),a=!0},p(_,p){const $={};p&4194304&&($.$$scope={dirty:p,ctx:_}),!n&&p&8&&(n=!0,$.checked=_[3],lt(()=>n=!1)),t.$set($);const c={};p&4194304&&(c.$$scope={dirty:p,ctx:_}),o.$set(c)},i(_){a||(d(t.$$.fragment,_),d(o.$$.fragment,_),a=!0)},o(_){b(t.$$.fragment,_),b(o.$$.fragment,_),a=!1},d(_){_&&u(e),O(t),O(o)}}}function ss(l){let e;return{c(){e=R("Deseo comprar la foto")},l(t){e=H(t,"Deseo comprar la foto")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function os(l){let e;return{c(){e=R("Se sortea entre los votantes interesados el derecho a compra")},l(t){e=H(t,"Se sortea entre los votantes interesados el derecho a compra")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function ls(l){var n;let e=((n=l[2])==null?void 0:n.remainingVotes)+"",t;return{c(){t=R(e)},l(s){t=H(s,e)},m(s,o){w(s,t,o)},p(s,o){var a;o&4&&e!==(e=((a=s[2])==null?void 0:a.remainingVotes)+"")&&Ee(t,e)},d(s){s&&u(t)}}}function as(l){let e,t,n;return t=new hn({props:{color:"primary",class:"text-sm",$$slots:{default:[ls]},$$scope:{ctx:l}}}),{c(){e=R("Votos disponibles: "),N(t.$$.fragment)},l(s){e=H(s,"Votos disponibles: "),M(t.$$.fragment,s)},m(s,o){w(s,e,o),y(t,s,o),n=!0},p(s,o){const a={};o&4194308&&(a.$$scope={dirty:o,ctx:s}),t.$set(a)},i(s){n||(d(t.$$.fragment,s),n=!0)},o(s){b(t.$$.fragment,s),n=!1},d(s){s&&u(e),O(t,s)}}}function rs(l){let e,t,n;return e=new De({props:{icon:en,class:"text-md mr-1"}}),{c(){N(e.$$.fragment),t=R(`
					Votar`)},l(s){M(e.$$.fragment,s),t=H(s,`
					Votar`)},m(s,o){y(e,s,o),w(s,t,o),n=!0},i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function fs(l){let e,t,n;return e=new En({props:{class:"me-3",size:"4",color:"white"}}),{c(){N(e.$$.fragment),t=R(`
					Votación en curso...`)},l(s){M(e.$$.fragment,s),t=H(s,`
					Votación en curso...`)},m(s,o){y(e,s,o),w(s,t,o),n=!0},i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function is(l){let e,t,n,s;const o=[fs,rs],a=[];function r(f,_){return f[4]?0:1}return e=r(l),t=a[e]=o[e](l),{c(){t.c(),n=Ge()},l(f){t.l(f),n=Ge()},m(f,_){a[e].m(f,_),w(f,n,_),s=!0},p(f,_){let p=e;e=r(f),e!==p&&(Se(),b(a[p],1,1,()=>{a[p]=null}),Ce(),t=a[e],t||(t=a[e]=o[e](f),t.c()),d(t,1),t.m(n.parentNode,n))},i(f){s||(d(t),s=!0)},o(f){b(t),s=!1},d(f){f&&u(n),a[e].d(f)}}}function us(l){let e,t,n,s,o,a,r,f,_,p,$,c,m,F,j,B,W,J,P;t=new _t({props:{class:"h-56 w-auto rounded m-auto",src:l[5]}}),o=new We({props:{for:"votes",class:"mb-2 w-full text-right",$$slots:{default:[es]},$$scope:{ctx:l}}});function I(k){l[13](k)}let q={id:"votes",required:!0,class:"w-full",min:"1"};l[1]!==void 0&&(q.value=l[1]),r=new yn({props:q}),Ye.push(()=>at(r,"value",I)),p=new Fe({props:{type:"button",outline:!0,color:"light",size:"xs",$$slots:{default:[ts]},$$scope:{ctx:l}}}),p.$on("click",l[14]),c=new Fe({props:{type:"button",outline:!0,color:"light",size:"xs",$$slots:{default:[ns]},$$scope:{ctx:l}}}),c.$on("click",l[15]);let C=!l[7]&&Tt(l);return j=new mt({props:{class:"text-sm self-center",$$slots:{default:[as]},$$scope:{ctx:l}}}),J=new Fe({props:{type:"button",disabled:!l[6],$$slots:{default:[is]},$$scope:{ctx:l}}}),J.$on("click",l[9]),{c(){e=E("div"),N(t.$$.fragment),n=V(),s=E("div"),N(o.$$.fragment),a=V(),N(r.$$.fragment),_=V(),N(p.$$.fragment),$=V(),N(c.$$.fragment),m=V(),C&&C.c(),F=V(),N(j.$$.fragment),B=V(),W=E("div"),N(J.$$.fragment),this.h()},l(k){e=S(k,"DIV",{class:!0});var z=L(e);M(t.$$.fragment,z),n=T(z),s=S(z,"DIV",{class:!0});var i=L(s);M(o.$$.fragment,i),a=T(i),M(r.$$.fragment,i),_=T(i),M(p.$$.fragment,i),$=T(i),M(c.$$.fragment,i),i.forEach(u),m=T(z),C&&C.l(z),F=T(z),M(j.$$.fragment,z),B=T(z),W=S(z,"DIV",{class:!0});var Y=L(W);M(J.$$.fragment,Y),Y.forEach(u),z.forEach(u),this.h()},h(){A(s,"class","flex flex-row items-baseline gap-2 w-52 self-center"),A(W,"class","flex justify-center col-span-2 mt-2"),A(e,"class","flex flex-col gap-2")},m(k,z){w(k,e,z),y(t,e,null),g(e,n),g(e,s),y(o,s,null),g(s,a),y(r,s,null),g(s,_),y(p,s,null),g(s,$),y(c,s,null),g(e,m),C&&C.m(e,null),g(e,F),y(j,e,null),g(e,B),g(e,W),y(J,W,null),P=!0},p(k,z){const i={};z&32&&(i.src=k[5]),t.$set(i);const Y={};z&4194304&&(Y.$$scope={dirty:z,ctx:k}),o.$set(Y);const ae={};!f&&z&2&&(f=!0,ae.value=k[1],lt(()=>f=!1)),r.$set(ae);const re={};z&4194304&&(re.$$scope={dirty:z,ctx:k}),p.$set(re);const he={};z&4194304&&(he.$$scope={dirty:z,ctx:k}),c.$set(he),k[7]?C&&(Se(),b(C,1,1,()=>{C=null}),Ce()):C?(C.p(k,z),z&128&&d(C,1)):(C=Tt(k),C.c(),d(C,1),C.m(e,F));const ce={};z&4194308&&(ce.$$scope={dirty:z,ctx:k}),j.$set(ce);const ve={};z&64&&(ve.disabled=!k[6]),z&4194320&&(ve.$$scope={dirty:z,ctx:k}),J.$set(ve)},i(k){P||(d(t.$$.fragment,k),d(o.$$.fragment,k),d(r.$$.fragment,k),d(p.$$.fragment,k),d(c.$$.fragment,k),d(C),d(j.$$.fragment,k),d(J.$$.fragment,k),P=!0)},o(k){b(t.$$.fragment,k),b(o.$$.fragment,k),b(r.$$.fragment,k),b(p.$$.fragment,k),b(c.$$.fragment,k),b(C),b(j.$$.fragment,k),b(J.$$.fragment,k),P=!1},d(k){k&&u(e),O(t),O(o),O(r),O(p),O(c),C&&C.d(),O(j),O(J)}}}function cs(l){let e,t,n;function s(a){l[17](a)}let o={title:"Votar por foto",class:"w-96",dismissable:!0,placement:"bottom-center",$$slots:{default:[us]},$$scope:{ctx:l}};return l[0]!==void 0&&(o.open=l[0]),e=new Ut({props:o}),Ye.push(()=>at(e,"open",s)),e.$on("close",l[10]),{c(){N(e.$$.fragment)},l(a){M(e.$$.fragment,a)},m(a,r){y(e,a,r),n=!0},p(a,[r]){const f={};r&4194558&&(f.$$scope={dirty:r,ctx:a}),!t&&r&1&&(t=!0,f.open=a[0],lt(()=>t=!1)),e.$set(f)},i(a){n||(d(e.$$.fragment,a),n=!0)},o(a){b(e.$$.fragment,a),n=!1},d(a){O(e,a)}}}function ps(l,e,t){let n,s,o,a,r,f,_;He(l,Jt,i=>t(19,_=i));const p=Ht(),$=Yt();He(l,$,i=>t(2,f=i)),cn(async()=>{const i=await Oe(`/api/account/${_}`);i.status===200&&(console.log("Refresh contest data..."),$.set(await i.json()))});let{openModal:m=!1}=e,{contestId:F}=e,{selectedPhoto:j}=e,B=1,W=!1;const J=async()=>{if(n)return;if(B<=0){ot("Debe ingresar una cantidad de votos válida");return}if(B>(f==null?void 0:f.remainingVotes)){ot("No tienes suficientes votos para realizar esta acción");return}t(4,n=!0);const i=await Oe(`/api/contest/${F}/vote`,{method:"POST",payload:{contestPhotoId:r,wantBuy:W,votes:B}});if(i.status===200){const Y=await i.json();p("voted",{contestPhotoId:Y.contestPhotoId,votes:Y.votes}),pn($,f.remainingVotes=Y.remainingVotes,f),t(0,m=!1)}t(4,n=!1)},P=()=>{t(0,m=!1),p("close")};function I(i){B=i,t(1,B)}const q=()=>{t(1,B+=5)},C=()=>{t(1,B=1)};function k(i){W=i,t(3,W)}function z(i){m=i,t(0,m)}return l.$$set=i=>{"openModal"in i&&t(0,m=i.openModal),"contestId"in i&&t(11,F=i.contestId),"selectedPhoto"in i&&t(12,j=i.selectedPhoto)},l.$$.update=()=>{var i;l.$$.dirty&4100&&t(7,s=(i=f==null?void 0:f.photos)==null?void 0:i.some(Y=>Y.photoKey===(j==null?void 0:j.photoKey))),l.$$.dirty&6&&t(6,o=(f==null?void 0:f.remainingVotes)>B),l.$$.dirty&4096&&t(5,a=`/api/photo/${j==null?void 0:j.photoKey}`),l.$$.dirty&4096&&(r=j==null?void 0:j.contestPhotoId)},t(4,n=!1),[m,B,f,W,n,a,o,s,$,J,P,F,j,I,q,C,k,z]}class ms extends Ze{constructor(e){super(),Qe(this,e,ps,cs,Xe,{openModal:0,contestId:11,selectedPhoto:12})}}function Nt(l,e,t){const n=l.slice();return n[23]=e[t],n}function Mt(l){let e,t,n,s;return e=new Fe({props:{outline:!0,size:"xs",color:"primary",$$slots:{default:[_s]},$$scope:{ctx:l}}}),e.$on("click",l[12]),n=new Fe({props:{outline:!0,size:"xs",color:"primary",$$slots:{default:[ds]},$$scope:{ctx:l}}}),n.$on("click",l[18]),{c(){N(e.$$.fragment),t=V(),N(n.$$.fragment)},l(o){M(e.$$.fragment,o),t=T(o),M(n.$$.fragment,o)},m(o,a){y(e,o,a),w(o,t,a),y(n,o,a),s=!0},p(o,a){const r={};a&67108864&&(r.$$scope={dirty:a,ctx:o}),e.$set(r);const f={};a&67108864&&(f.$$scope={dirty:a,ctx:o}),n.$set(f)},i(o){s||(d(e.$$.fragment,o),d(n.$$.fragment,o),s=!0)},o(o){b(e.$$.fragment,o),b(n.$$.fragment,o),s=!1},d(o){o&&u(t),O(e,o),O(n,o)}}}function _s(l){let e,t,n;return e=new De({props:{icon:bn,class:"w-5 h-5 mr-1"}}),{c(){N(e.$$.fragment),t=R(`
						Iniciar ahora`)},l(s){M(e.$$.fragment,s),t=H(s,`
						Iniciar ahora`)},m(s,o){y(e,s,o),w(s,t,o),n=!0},p:Me,i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function ds(l){let e,t,n;return e=new De({props:{icon:vn,class:"w-5 h-5 mr-1"}}),{c(){N(e.$$.fragment),t=R(`
						Modificar`)},l(s){M(e.$$.fragment,s),t=H(s,`
						Modificar`)},m(s,o){y(e,s,o),w(s,t,o),n=!0},p:Me,i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function yt(l){let e,t;return e=new Fe({props:{outline:!0,size:"xs",class:"button-secondary",$$slots:{default:[$s]},$$scope:{ctx:l}}}),e.$on("click",l[11]),{c(){N(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){y(e,n,s),t=!0},p(n,s){const o={};s&67108864&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){b(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function $s(l){let e,t,n;return e=new De({props:{icon:Bt,class:"w-5 h-5 mr-1"}}),{c(){N(e.$$.fragment),t=R(`
						Nueva foto`)},l(s){M(e.$$.fragment,s),t=H(s,`
						Nueva foto`)},m(s,o){y(e,s,o),w(s,t,o),n=!0},p:Me,i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function Ot(l){let e,t,n,s;return e=new _t({props:{src:"/api/photo/"+l[8].photoKey,imgClass:"max-h-56 w-auto"}}),n=new kn({props:{$$slots:{default:[hs]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment),t=V(),N(n.$$.fragment)},l(o){M(e.$$.fragment,o),t=T(o),M(n.$$.fragment,o)},m(o,a){y(e,o,a),w(o,t,a),y(n,o,a),s=!0},p(o,a){const r={};a&256&&(r.src="/api/photo/"+o[8].photoKey),e.$set(r);const f={};a&67108864&&(f.$$scope={dirty:a,ctx:o}),n.$set(f)},i(o){s||(d(e.$$.fragment,o),d(n.$$.fragment,o),s=!0)},o(o){b(e.$$.fragment,o),b(n.$$.fragment,o),s=!1},d(o){o&&u(t),O(e,o),O(n,o)}}}function hs(l){let e;return{c(){e=R("Foto ganadora")},l(t){e=H(t,"Foto ganadora")},m(t,n){w(t,e,n)},d(t){t&&u(e)}}}function Ft(l){var W,J;let e,t,n,s,o=((W=l[8])==null?void 0:W.title)+"",a,r,f,_,p,$,c,m=(((J=l[1].totalPrize)==null?void 0:J.toFixed(2))||0)+"",F,j,B;return t=new De({props:{icon:nn,size:"lg",class:"mr-1 ",color:"orange"}}),p=new De({props:{icon:sn,class:"w-5 h-5 mt-1",color:"green"}}),{c(){e=E("div"),N(t.$$.fragment),n=V(),s=E("span"),a=R(o),r=V(),f=E("span"),_=R(`Premio:
			`),N(p.$$.fragment),$=V(),c=E("strong"),F=R(m),j=R(" €"),this.h()},l(P){e=S(P,"DIV",{class:!0});var I=L(e);M(t.$$.fragment,I),n=T(I),s=S(I,"SPAN",{});var q=L(s);a=H(q,o),q.forEach(u),I.forEach(u),r=T(P),f=S(P,"SPAN",{class:!0});var C=L(f);_=H(C,`Premio:
			`),M(p.$$.fragment,C),$=T(C),c=S(C,"STRONG",{class:!0});var k=L(c);F=H(k,m),j=H(k," €"),k.forEach(u),C.forEach(u),this.h()},h(){A(e,"class","text-lg text-gray-900 flex flex-row gap-2 items-center font-semibold"),A(c,"class",""),A(f,"class","text-md flex gap-1")},m(P,I){w(P,e,I),y(t,e,null),g(e,n),g(e,s),g(s,a),w(P,r,I),w(P,f,I),g(f,_),y(p,f,null),g(f,$),g(f,c),g(c,F),g(c,j),B=!0},p(P,I){var q,C;(!B||I&256)&&o!==(o=((q=P[8])==null?void 0:q.title)+"")&&Ee(a,o),(!B||I&2)&&m!==(m=(((C=P[1].totalPrize)==null?void 0:C.toFixed(2))||0)+"")&&Ee(F,m)},i(P){B||(d(t.$$.fragment,P),d(p.$$.fragment,P),B=!0)},o(P){b(t.$$.fragment,P),b(p.$$.fragment,P),B=!1},d(P){P&&(u(e),u(r),u(f)),O(t),O(p)}}}function jt(l){let e,t;return e=new gn({props:{imgSrc:"/api/photo/"+l[23].photoKey,badgeContent:l[23].ownVotes??null,$$slots:{default:[ws]},$$scope:{ctx:l}}}),{c(){N(e.$$.fragment)},l(n){M(e.$$.fragment,n)},m(n,s){y(e,n,s),t=!0},p(n,s){const o={};s&32&&(o.imgSrc="/api/photo/"+n[23].photoKey),s&32&&(o.badgeContent=n[23].ownVotes??null),s&67108898&&(o.$$scope={dirty:s,ctx:n}),e.$set(o)},i(n){t||(d(e.$$.fragment,n),t=!0)},o(n){b(e.$$.fragment,n),t=!1},d(n){O(e,n)}}}function gs(l){let e,t=" ";return{c(){e=E("p"),e.textContent=t,this.h()},l(n){e=S(n,"P",{class:!0,"data-svelte-h":!0}),je(e)!=="svelte-187adop"&&(e.textContent=t),this.h()},h(){A(e,"class","text-sm")},m(n,s){w(n,e,s)},p:Me,d(n){n&&u(e)}}}function bs(l){let e,t,n,s=l[23].price+"",o,a;return{c(){e=E("p"),t=R("Precio de venta: "),n=E("strong"),o=R(s),a=R(" €"),this.h()},l(r){e=S(r,"P",{class:!0});var f=L(e);t=H(f,"Precio de venta: "),n=S(f,"STRONG",{});var _=L(n);o=H(_,s),a=H(_," €"),_.forEach(u),f.forEach(u),this.h()},h(){A(e,"class","text-sm")},m(r,f){w(r,e,f),g(e,t),g(e,n),g(n,o),g(n,a)},p(r,f){f&32&&s!==(s=r[23].price+"")&&Ee(o,s)},d(r){r&&u(e)}}}function zt(l){let e,t,n;function s(...o){return l[20](l[23],...o)}return t=new Fe({props:{color:"light",size:"xs",$$slots:{default:[vs]},$$scope:{ctx:l}}}),t.$on("click",s),{c(){e=E("div"),N(t.$$.fragment),this.h()},l(o){e=S(o,"DIV",{class:!0});var a=L(e);M(t.$$.fragment,a),a.forEach(u),this.h()},h(){A(e,"class","flex justify-end mt-2 svelte-vu4f5c")},m(o,a){w(o,e,a),y(t,e,null),n=!0},p(o,a){l=o;const r={};a&67108864&&(r.$$scope={dirty:a,ctx:l}),t.$set(r)},i(o){n||(d(t.$$.fragment,o),n=!0)},o(o){b(t.$$.fragment,o),n=!1},d(o){o&&u(e),O(t)}}}function vs(l){let e,t,n;return e=new De({props:{icon:wn,class:"w-5 h-5 mr-1"}}),{c(){N(e.$$.fragment),t=R(" Vota")},l(s){M(e.$$.fragment,s),t=H(s," Vota")},m(s,o){y(e,s,o),w(s,t,o),n=!0},p:Me,i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function ws(l){let e,t=l[23].title+"",n,s,o,a,r;function f(c,m){return c[23].price?bs:gs}let _=f(l),p=_(l),$=l[1].status!=="finished"&&zt(l);return{c(){e=E("h5"),n=R(t),s=V(),p.c(),o=V(),$&&$.c(),a=V(),this.h()},l(c){e=S(c,"H5",{class:!0});var m=L(e);n=H(m,t),m.forEach(u),s=T(c),p.l(c),o=T(c),$&&$.l(c),a=T(c),this.h()},h(){A(e,"class","mb-2 text-lg font-semibold tracking-tight")},m(c,m){w(c,e,m),g(e,n),w(c,s,m),p.m(c,m),w(c,o,m),$&&$.m(c,m),w(c,a,m),r=!0},p(c,m){(!r||m&32)&&t!==(t=c[23].title+"")&&Ee(n,t),_===(_=f(c))&&p?p.p(c,m):(p.d(1),p=_(c),p&&(p.c(),p.m(o.parentNode,o))),c[1].status!=="finished"?$?($.p(c,m),m&2&&d($,1)):($=zt(c),$.c(),d($,1),$.m(a.parentNode,a)):$&&(Se(),b($,1,1,()=>{$=null}),Ce())},i(c){r||(d($),r=!0)},o(c){b($),r=!1},d(c){c&&(u(e),u(s),u(o),u(a)),p.d(c),$&&$.d(c)}}}function At(l){let e,t,n=!l[23].winner&&jt(l);return{c(){n&&n.c(),e=Ge()},l(s){n&&n.l(s),e=Ge()},m(s,o){n&&n.m(s,o),w(s,e,o),t=!0},p(s,o){s[23].winner?n&&(Se(),b(n,1,1,()=>{n=null}),Ce()):n?(n.p(s,o),o&32&&d(n,1)):(n=jt(s),n.c(),d(n,1),n.m(e.parentNode,e))},i(s){t||(d(n),t=!0)},o(s){b(n),t=!1},d(s){s&&u(e),n&&n.d(s)}}}function Lt(l){let e,t,n="No hay fotos en este concurso, añade la primera",s,o,a;return o=new Fe({props:{type:"button",color:"light",class:"button-secondary",$$slots:{default:[ks]},$$scope:{ctx:l}}}),o.$on("click",l[11]),{c(){e=E("div"),t=E("span"),t.textContent=n,s=V(),N(o.$$.fragment),this.h()},l(r){e=S(r,"DIV",{class:!0});var f=L(e);t=S(f,"SPAN",{class:!0,"data-svelte-h":!0}),je(t)!=="svelte-1dag9rs"&&(t.textContent=n),s=T(f),M(o.$$.fragment,f),f.forEach(u),this.h()},h(){A(t,"class","text-gray-400 mb-3 mt-10"),A(e,"class","flex flex-col items-center w-full h-full")},m(r,f){w(r,e,f),g(e,t),g(e,s),y(o,e,null),a=!0},p(r,f){const _={};f&67108864&&(_.$$scope={dirty:f,ctx:r}),o.$set(_)},i(r){a||(d(o.$$.fragment,r),a=!0)},o(r){b(o.$$.fragment,r),a=!1},d(r){r&&u(e),O(o)}}}function ks(l){let e,t,n;return e=new De({props:{icon:Kt,class:"text-xl mr-2"}}),{c(){N(e.$$.fragment),t=R(`
			Subir foto`)},l(s){M(e.$$.fragment,s),t=H(s,`
			Subir foto`)},m(s,o){y(e,s,o),w(s,t,o),n=!0},p:Me,i(s){n||(d(e.$$.fragment,s),n=!0)},o(s){b(e.$$.fragment,s),n=!1},d(s){s&&u(t),O(e,s)}}}function Ps(l){var dt;let e,t,n,s,o=l[1].title+"",a,r,f,_,p,$,c,m,F,j=l[1].description+"",B,W,J,P,I,q,C,k,z=Pt(l[1].status)+"",i,Y,ae,re,he,ce=(((dt=l[1].photos)==null?void 0:dt.length)||0)+"",ve,U,G,x,ie,we=xe.fromISO(l[1].initTimestamp).toLocaleString(et)+"",ge,X,ke,Ve,ze,Pe=xe.fromISO(l[1].endTimestamp).toLocaleString(et)+"",Ae,ne,v,K,Ie,fe,me,$e,Te,pe,_e,Z=l[9]&&l[1].status==="pending"&&Mt(l),ee=l[1].status!=="finished"&&yt(l),te=l[8]&&Ot(l),se=l[8]&&Ft(l);q=new De({props:{icon:tn,class:"w-5 h-5 mt-1 text-"+It(l[1].status)+"-600"}});let Re=st(l[5]),oe=[];for(let h=0;h<Re.length;h+=1)oe[h]=At(Nt(l,Re,h));const Zt=h=>b(oe[h],1,1,()=>{oe[h]=null});let ue=l[5].length===0&&Lt(l);return fe=new xn({props:{contestId:l[7],fees:l[0].fees,openModal:l[6]}}),fe.$on("created",l[13]),fe.$on("close",l[14]),$e=new ms({props:{contestId:l[7],selectedPhoto:l[4],openModal:l[3]}}),$e.$on("voted",l[16]),$e.$on("close",l[21]),pe=new mn({props:{contestData:l[1],openModal:l[2]}}),pe.$on("updated",l[10]),pe.$on("close",l[15]),{c(){e=E("div"),t=E("div"),n=E("h1"),s=R("Concurso: "),a=R(o),r=V(),f=E("div"),Z&&Z.c(),_=V(),ee&&ee.c(),p=V(),$=E("div"),te&&te.c(),c=V(),m=E("div"),F=E("pre"),B=R(j),W=V(),se&&se.c(),J=V(),P=E("span"),I=R(`Estado:
			`),N(q.$$.fragment),C=V(),k=E("strong"),i=R(z),Y=V(),ae=E("span"),re=R(`Total de fotos:			
			`),he=E("strong"),ve=R(ce),U=V(),G=E("span"),x=R("Fecha de inicio: "),ie=E("strong"),ge=R(we),X=V(),ke=E("span"),Ve=R("Fecha de fin: "),ze=E("strong"),Ae=R(Pe),ne=V(),v=E("div");for(let h=0;h<oe.length;h+=1)oe[h].c();K=V(),ue&&ue.c(),Ie=V(),N(fe.$$.fragment),me=V(),N($e.$$.fragment),Te=V(),N(pe.$$.fragment),this.h()},l(h){e=S(h,"DIV",{class:!0});var D=L(e);t=S(D,"DIV",{class:!0});var Ne=L(t);n=S(Ne,"H1",{class:!0});var Le=L(n);s=H(Le,"Concurso: "),a=H(Le,o),Le.forEach(u),r=T(Ne),f=S(Ne,"DIV",{class:!0});var ye=L(f);Z&&Z.l(ye),_=T(ye),ee&&ee.l(ye),ye.forEach(u),Ne.forEach(u),p=T(D),$=S(D,"DIV",{class:!0});var Ue=L($);te&&te.l(Ue),c=T(Ue),m=S(Ue,"DIV",{class:!0});var be=L(m);F=S(be,"PRE",{class:!0});var de=L(F);B=H(de,j),de.forEach(u),W=T(be),se&&se.l(be),J=T(be),P=S(be,"SPAN",{class:!0});var Ke=L(P);I=H(Ke,`Estado:
			`),M(q.$$.fragment,Ke),C=T(Ke),k=S(Ke,"STRONG",{class:!0});var $t=L(k);i=H($t,z),$t.forEach(u),Ke.forEach(u),Y=T(be),ae=S(be,"SPAN",{class:!0});var ft=L(ae);re=H(ft,`Total de fotos:			
			`),he=S(ft,"STRONG",{});var ht=L(he);ve=H(ht,ce),ht.forEach(u),ft.forEach(u),U=T(be),G=S(be,"SPAN",{class:!0});var it=L(G);x=H(it,"Fecha de inicio: "),ie=S(it,"STRONG",{});var gt=L(ie);ge=H(gt,we),gt.forEach(u),it.forEach(u),X=T(be),ke=S(be,"SPAN",{class:!0});var ut=L(ke);Ve=H(ut,"Fecha de fin: "),ze=S(ut,"STRONG",{});var bt=L(ze);Ae=H(bt,Pe),bt.forEach(u),ut.forEach(u),be.forEach(u),Ue.forEach(u),D.forEach(u),ne=T(h),v=S(h,"DIV",{class:!0});var vt=L(v);for(let ct=0;ct<oe.length;ct+=1)oe[ct].l(vt);vt.forEach(u),K=T(h),ue&&ue.l(h),Ie=T(h),M(fe.$$.fragment,h),me=T(h),M($e.$$.fragment,h),Te=T(h),M(pe.$$.fragment,h),this.h()},h(){A(n,"class","text-xl font-semibold"),A(f,"class","flex flex-row gap-2 justify-end"),A(t,"class","flex flex-row gap-2 justify-between"),A(F,"class","text-xs font-sans"),A(k,"class",""),A(P,"class","text-sm flex"),A(ae,"class","text-sm flex gap-1"),A(G,"class","text-sm"),A(ke,"class","text-sm"),A(m,"class","flex flex-col gap-2 grow"),A($,"class","flex flex-row gap-2 justify-between"),A(e,"class","flex flex-col gap-2 shadow-md rounded-sm p-2 bg-surface-200"),A(v,"class","flex flex-row gap-2 flex-wrap photos mt-3 svelte-vu4f5c")},m(h,D){w(h,e,D),g(e,t),g(t,n),g(n,s),g(n,a),g(t,r),g(t,f),Z&&Z.m(f,null),g(f,_),ee&&ee.m(f,null),g(e,p),g(e,$),te&&te.m($,null),g($,c),g($,m),g(m,F),g(F,B),g(m,W),se&&se.m(m,null),g(m,J),g(m,P),g(P,I),y(q,P,null),g(P,C),g(P,k),g(k,i),g(m,Y),g(m,ae),g(ae,re),g(ae,he),g(he,ve),g(m,U),g(m,G),g(G,x),g(G,ie),g(ie,ge),g(m,X),g(m,ke),g(ke,Ve),g(ke,ze),g(ze,Ae),w(h,ne,D),w(h,v,D);for(let Ne=0;Ne<oe.length;Ne+=1)oe[Ne]&&oe[Ne].m(v,null);w(h,K,D),ue&&ue.m(h,D),w(h,Ie,D),y(fe,h,D),w(h,me,D),y($e,h,D),w(h,Te,D),y(pe,h,D),_e=!0},p(h,[D]){var be;(!_e||D&2)&&o!==(o=h[1].title+"")&&Ee(a,o),h[9]&&h[1].status==="pending"?Z?(Z.p(h,D),D&514&&d(Z,1)):(Z=Mt(h),Z.c(),d(Z,1),Z.m(f,_)):Z&&(Se(),b(Z,1,1,()=>{Z=null}),Ce()),h[1].status!=="finished"?ee?(ee.p(h,D),D&2&&d(ee,1)):(ee=yt(h),ee.c(),d(ee,1),ee.m(f,null)):ee&&(Se(),b(ee,1,1,()=>{ee=null}),Ce()),h[8]?te?(te.p(h,D),D&256&&d(te,1)):(te=Ot(h),te.c(),d(te,1),te.m($,c)):te&&(Se(),b(te,1,1,()=>{te=null}),Ce()),(!_e||D&2)&&j!==(j=h[1].description+"")&&Ee(B,j),h[8]?se?(se.p(h,D),D&256&&d(se,1)):(se=Ft(h),se.c(),d(se,1),se.m(m,J)):se&&(Se(),b(se,1,1,()=>{se=null}),Ce());const Ne={};if(D&2&&(Ne.class="w-5 h-5 mt-1 text-"+It(h[1].status)+"-600"),q.$set(Ne),(!_e||D&2)&&z!==(z=Pt(h[1].status)+"")&&Ee(i,z),(!_e||D&2)&&ce!==(ce=(((be=h[1].photos)==null?void 0:be.length)||0)+"")&&Ee(ve,ce),(!_e||D&2)&&we!==(we=xe.fromISO(h[1].initTimestamp).toLocaleString(et)+"")&&Ee(ge,we),(!_e||D&2)&&Pe!==(Pe=xe.fromISO(h[1].endTimestamp).toLocaleString(et)+"")&&Ee(Ae,Pe),D&131106){Re=st(h[5]);let de;for(de=0;de<Re.length;de+=1){const Ke=Nt(h,Re,de);oe[de]?(oe[de].p(Ke,D),d(oe[de],1)):(oe[de]=At(Ke),oe[de].c(),d(oe[de],1),oe[de].m(v,null))}for(Se(),de=Re.length;de<oe.length;de+=1)Zt(de);Ce()}h[5].length===0?ue?(ue.p(h,D),D&32&&d(ue,1)):(ue=Lt(h),ue.c(),d(ue,1),ue.m(Ie.parentNode,Ie)):ue&&(Se(),b(ue,1,1,()=>{ue=null}),Ce());const Le={};D&128&&(Le.contestId=h[7]),D&1&&(Le.fees=h[0].fees),D&64&&(Le.openModal=h[6]),fe.$set(Le);const ye={};D&128&&(ye.contestId=h[7]),D&16&&(ye.selectedPhoto=h[4]),D&8&&(ye.openModal=h[3]),$e.$set(ye);const Ue={};D&2&&(Ue.contestData=h[1]),D&4&&(Ue.openModal=h[2]),pe.$set(Ue)},i(h){if(!_e){d(Z),d(ee),d(te),d(se),d(q.$$.fragment,h);for(let D=0;D<Re.length;D+=1)d(oe[D]);d(ue),d(fe.$$.fragment,h),d($e.$$.fragment,h),d(pe.$$.fragment,h),_e=!0}},o(h){b(Z),b(ee),b(te),b(se),b(q.$$.fragment,h),oe=oe.filter(Boolean);for(let D=0;D<oe.length;D+=1)b(oe[D]);b(ue),b(fe.$$.fragment,h),b($e.$$.fragment,h),b(pe.$$.fragment,h),_e=!1},d(h){h&&(u(e),u(ne),u(v),u(K),u(Ie),u(me),u(Te)),Z&&Z.d(),ee&&ee.d(),te&&te.d(),se&&se.d(),O(q),Wt(oe,h),ue&&ue.d(h),O(fe,h),O($e,h),O(pe,h)}}}function Is(l,e,t){let n,s,o,a,r,f,_,p,$,c;He(l,qt,i=>t(19,$=i)),He(l,$n,i=>t(9,c=i));let{data:m}=e;const F=async i=>{t(1,s={...s,...i.detail})},j=async()=>{t(6,r=!0)},B=async()=>{const i=await Oe(`/api/contest/${n}/init`,{method:"POST"});i.status===200&&t(1,s={...s,...await i.json()})},W=async i=>{t(1,s={...s,photos:[...s.photos,i.detail]}),J()},J=async()=>{t(6,r=!1)},P=async()=>{t(2,_=!1)},I=async i=>{const{contestPhotoId:Y,votes:ae}=i.detail,re=a.find(he=>he.contestPhotoId===Y);re&&(re.ownVotes=(re.ownVotes||0)+ae,t(4,p=void 0),t(5,a=[...a]))},q=async(i,Y)=>{t(4,p=i),t(3,f=!0)},C=async()=>{t(2,_=!0)},k=(i,Y)=>q(i,Y.target),z=()=>t(3,f=!1);return l.$$set=i=>{"data"in i&&t(0,m=i.data)},l.$$.update=()=>{var i;l.$$.dirty&524288&&t(7,n=$),l.$$.dirty&1&&t(1,s=m.contestData),l.$$.dirty&2&&t(8,o=s.status==="finished"?(i=s.photos)==null?void 0:i.find(Y=>Y.winner):void 0),l.$$.dirty&2&&t(5,a=s.photos||[])},t(6,r=!1),t(3,f=!1),t(2,_=!1),t(4,p=void 0),[m,s,_,f,p,a,r,n,o,c,F,j,B,W,J,P,I,q,C,$,k,z]}class Gs extends Ze{constructor(e){super(),Qe(this,e,Is,Ps,Xe,{data:0})}}export{Gs as component,Bs as universal};
